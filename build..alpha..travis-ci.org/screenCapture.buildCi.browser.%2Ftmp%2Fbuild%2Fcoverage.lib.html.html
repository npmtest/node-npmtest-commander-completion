<html lang="en"><head>
    <title>Code coverage report for node-npmtest-commander-completion/node_modules/commander-completion/lib/commander-completion.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-commander-completion">npmtest-commander-completion (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-commander-completion/node_modules/commander-completion/lib/commander-completion.js</span></h1>
    <h2>
        
        Statements: <span class="metric">14% <small>(7 / 50)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 12)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">14% <small>(7 / 50)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> » <a href="index.html">node-npmtest-commander-completion/node_modules/commander-completion/lib/</a> » commander-completion.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tbody><tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// Load in dependencies
var Completion = require('completion');
&nbsp;
// Define a prototype for the would-be class
// DEV: We don't create a sub-class because `Command.command()` doesn't return an instance of `this`
var CompletableProto = {
  // Save a completion command for the current command
  completion: <span class="fstat-no" title="function not covered">function (_completion) {</span>
<span class="cstat-no" title="statement not covered">    this._completion = _completion;</span>
<span class="cstat-no" title="statement not covered">    return this;</span>
  },
  // Create method to invoke completion for this command
  complete: <span class="fstat-no" title="function not covered">function (params, cb) {</span>
    // TODO: We should fallback to environment variables (e.g. COMP_CWORD)
    // TODO: If we are invoked sans params. slice off the first 2 parameters of `line` (e.g. `node /usr/bin/abc`)
    // Fallback cb
<span class="cstat-no" title="statement not covered">    cb = cb || <span class="fstat-no" title="function not covered">function (err, results) {</span></span>
      // If there was an error, throw it
<span class="cstat-no" title="statement not covered">      if (err) {</span>
<span class="cstat-no" title="statement not covered">        throw err;</span>
      }
&nbsp;
      // Otherwise, log each result
<span class="cstat-no" title="statement not covered">      results.forEach(<span class="fstat-no" title="function not covered">function (result) {</span></span>
<span class="cstat-no" title="statement not covered">        console.log(result);</span>
      });
    };
&nbsp;
    // Generate a new Completion based off of this command
<span class="fstat-no" title="function not covered">    function getCompletionTree(node) {</span>
      // By default, look for completion logic
      // DEV: This is defined by running the `completion` command on a command
      // which then saves the logic to the command itself
<span class="cstat-no" title="statement not covered">      var nodeName = node.name;</span>
<span class="cstat-no" title="statement not covered">      if (nodeName) {</span>
        // `name` for programs (string on older versions of Commander, function on newer)
<span class="cstat-no" title="statement not covered">        if (typeof nodeName === 'function') {</span>
<span class="cstat-no" title="statement not covered">          nodeName = node.name();</span>
        }
      } else {
        // `_name` for commands
<span class="cstat-no" title="statement not covered">        nodeName = node._name;</span>
      }
<span class="cstat-no" title="statement not covered">      var retVal = {</span>
        // TODO: We need to be able to require `name` for programs
        name: nodeName
      };
&nbsp;
      // If there is completion logic, save it
<span class="cstat-no" title="statement not covered">      if (node._completion) {</span>
<span class="cstat-no" title="statement not covered">        retVal.completion = node._completion;</span>
      // Otherwise
      } else {
        // Recurse each of the commands as a child
<span class="cstat-no" title="statement not covered">        retVal.commands = node.commands.map(<span class="fstat-no" title="function not covered">function addCommand (command) {</span></span>
          // Add the command to our list
<span class="cstat-no" title="statement not covered">          return getCompletionTree(command);</span>
        });
      }
&nbsp;
      // If there are any options on that command, add those as viable venues
<span class="cstat-no" title="statement not covered">      retVal.options = [];</span>
<span class="cstat-no" title="statement not covered">      node.options.forEach(<span class="fstat-no" title="function not covered">function addCommandOption (option) {</span></span>
        // Define common option handler
<span class="fstat-no" title="function not covered">        function completeOption(info, cb) {</span>
          // If the option is required, shift the next word
<span class="cstat-no" title="statement not covered">          if (option.required) {</span>
<span class="cstat-no" title="statement not covered">            info = this.shiftLeftWord(info);</span>
          }
&nbsp;
          // If the option is optional
<span class="cstat-no" title="statement not covered">          if (option.optional) {</span>
            // If the next word is not an option, then use it (e.g. does not start with `-`)
<span class="cstat-no" title="statement not covered">            var leftmostWord = info.words.remainingLeft[0];</span>
<span class="cstat-no" title="statement not covered">            if (leftmostWord &amp;&amp; leftmostWord[0] !== '-') {</span>
<span class="cstat-no" title="statement not covered">              info = this.shiftLeftWord(info);</span>
            }
          }
&nbsp;
          // Keep on recursing
<span class="cstat-no" title="statement not covered">          this.resolveInfo(info, cb);</span>
        }
&nbsp;
        // If there is a short key, use it (e.g. `-n`)
<span class="cstat-no" title="statement not covered">        if (option.short) {</span>
<span class="cstat-no" title="statement not covered">          retVal.options.push({</span>
            name: option.short,
            completion: completeOption
          });
        }
&nbsp;
        // If there is a long key, use it (e.g. `--dry-run`)
<span class="cstat-no" title="statement not covered">        if (option.long) {</span>
<span class="cstat-no" title="statement not covered">          retVal.options.push({</span>
            name: option.long,
            completion: completeOption
          });
        }
      });
&nbsp;
      // Return our retVal
<span class="cstat-no" title="statement not covered">      return retVal;</span>
    }
<span class="cstat-no" title="statement not covered">    var tree = getCompletionTree(this);</span>
<span class="cstat-no" title="statement not covered">    var completion = new Completion(tree);</span>
&nbsp;
    // If the program does not have a name, callback with an error
<span class="cstat-no" title="statement not covered">    if (completion.name) {</span>
<span class="cstat-no" title="statement not covered">      var err = new Error('`commander-completion` requires `program.name` to be defined in order to operate');</span>
<span class="cstat-no" title="statement not covered">      return process.nextTick(<span class="fstat-no" title="function not covered">function () {</span></span>
<span class="cstat-no" title="statement not covered">        cb(err);</span>
      });
    }
&nbsp;
    // Parse the arguments
<span class="cstat-no" title="statement not covered">    completion.complete(params, cb);</span>
  }
};
&nbsp;
// Define and bind a mixin method
<span class="fstat-no" title="function not covered">function mixinCommandPrototype(commandPrototype) {</span>
<span class="cstat-no" title="statement not covered">  Object.getOwnPropertyNames(CompletableProto).forEach(<span class="fstat-no" title="function not covered">function (key) {</span></span>
<span class="cstat-no" title="statement not covered">    commandPrototype[key] = CompletableProto[key];</span>
  });
<span class="cstat-no" title="statement not covered">  return commandPrototype;</span>
}
module.exports = <span class="fstat-no" title="function not covered">function mixinCommanderCompletion (commander) {</span>
<span class="cstat-no" title="statement not covered">  mixinCommandPrototype(commander.Command.prototype);</span>
<span class="cstat-no" title="statement not covered">  return commander;</span>
};
module.exports.mixinCommandPrototype = mixinCommandPrototype;
&nbsp;
&nbsp;</pre></td></tr>
</tbody></table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Thu Apr 20 2017 17:17:27 GMT+0000 (UTC)</div>
</div>


</body></html>